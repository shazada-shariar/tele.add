import base64
exec(base64.b64decode('ZnJvbSB0ZWxldGhvbi5zeW5jIGltcG9ydCBUZWxlZ3JhbUNsaWVudApmcm9tIHRlbGV0aG9uLnRsLmZ1bmN0aW9ucy5tZXNzYWdlcyBpbXBvcnQgR2V0RGlhbG9nc1JlcXVlc3QKZnJvbSB0ZWxldGhvbi50bC50eXBlcyBpbXBvcnQgSW5wdXRQZWVyRW1wdHkKaW1wb3J0IG9zLCBzeXMKaW1wb3J0IGNvbmZpZ3BhcnNlcgppbXBvcnQgY3N2CmltcG9ydCB0aW1lCgpyZT0iXDAzM1sxOzMxbSIKZ3I9IlwwMzNbMTszMm0iCmN5PSJcMDMzWzE7MzZtIgoKZGVmIGJhbm5lcigpOgogICAgcHJpbnQoZiIiIgp7cmV9X19fw5dfX197Y3l9X19fw5dfX3tyZX1fX19fw5dfX19fe2N5fV9fX19fw5dfX19fXwp7cmV9X19fU19fX197Y3l9X19VTF9fXyB7cmV9X19fVEFfX19fX3tjeX1fX19fTl9fX19fXwp7cmV9X19fX1NIX19fX19fIHtjeX1fX19BUl9fX3tyZX1fX19fSUFfX19fX3tjeX1fX19fX1JfX19fCiAgICAgICAgICDilZTilZDilZDilabilabilabilabilZDilZDilabilZDilZDilabilZDilabilZcKICAgICAgICAgIOKVkeKVkOKVkOKVo+KVkeKVkeKVoOKVl+KVlOKVo+KVlOKVl+KVkeKVkeKVkeKVkQogICAgICAgICAg4pWg4pWQ4pWQ4pWR4pWR4pWR4pWa4pWj4pWR4pWR4pWg4pWj4pWR4pWR4pWR4pWRCiAgICAgICAgICDilZrilZDilZDilanilZDilanilZDilanilZ3ilZrilZ3ilZrilanilanilZDilZ0Ke3JlfSAgICAgICAgICAgICAgICAgICAg4pWU4pWQ4pWQ4pWm4pWX4pWU4pWm4pWQ4pWQ4pWm4pWQ4pWm4pWQ4pWQ4pWm4pWQ4pWQ4pWm4pWQ4pWXCntyZX0gICAgICAgICAgICAgICAgICAgIOKVkeKVkOKVkOKVo+KVmuKVneKVkeKVlOKVl+KVkeKVrOKVoOKVkeKVkeKVo+KVlOKVl+KVkeKVrOKVkQp7cmV9ICAgICAgICAgICAgICAgICAgICDilaDilZDilZDilZHilZTilZfilZHilaDilaPilZHilZfilazilZHilZHilaPilaDilaPilZHilZfilaMKe3JlfSAgICAgICAgICAgICAgICAgICAg4pWa4pWQ4pWQ4pWp4pWd4pWa4pWp4pWd4pWa4pWp4pWp4pWp4pWQ4pWQ4pWp4pWd4pWa4pWp4pWp4pWdCgogICAgICAgICAgICAgIFZlcnNpb24gOiAyLjAuMAoge3JlfVN1YnNjcmliZSBvdXIgVGVsZWdyYW1lIENoYWluYWwuCiAgIHtjeX1odHRwczovL3QubWUvaHR0cFRyZW1heGNvbW1hbmRzCiAgICAgICAgIiIiKQoKY3Bhc3MgPSBjb25maWdwYXJzZXIuUmF3Q29uZmlnUGFyc2VyKCkKY3Bhc3MucmVhZCgnY29uZmlnLmRhdGEnKQoKdHJ5OgogICAgYXBpX2lkID0gY3Bhc3NbJ2NyZWQnXVsnaWQnXQogICAgYXBpX2hhc2ggPSBjcGFzc1snY3JlZCddWydoYXNoJ10KICAgIHBob25lID0gY3Bhc3NbJ2NyZWQnXVsncGhvbmUnXQogICAgY2xpZW50ID0gVGVsZWdyYW1DbGllbnQocGhvbmUsIGFwaV9pZCwgYXBpX2hhc2gpCmV4Y2VwdCBLZXlFcnJvcjoKICAgIG9zLnN5c3RlbSgnY2xlYXInKQogICAgYmFubmVyKCkKICAgIHByaW50KHJlKyJbIV0gcnVuIHB5dGhvbjMgc2V0dXAucHkgZmlyc3QgISFcbiIpCiAgICBzeXMuZXhpdCgxKQoKY2xpZW50LmNvbm5lY3QoKQppZiBub3QgY2xpZW50LmlzX3VzZXJfYXV0aG9yaXplZCgpOgogICAgY2xpZW50LnNlbmRfY29kZV9yZXF1ZXN0KHBob25lKQogICAgb3Muc3lzdGVtKCdjbGVhcicpCiAgICBiYW5uZXIoKQogICAgY2xpZW50LnNpZ25faW4ocGhvbmUsIGlucHV0KGdyKydbK10gRW50ZXIgdGhlIGNvZGU6ICcrcmUpKQogCm9zLnN5c3RlbSgnY2xlYXInKQpiYW5uZXIoKQpjaGF0cyA9IFtdCmxhc3RfZGF0ZSA9IE5vbmUKY2h1bmtfc2l6ZSA9IDIwMApncm91cHM9W10KIApyZXN1bHQgPSBjbGllbnQoR2V0RGlhbG9nc1JlcXVlc3QoCiAgICAgICAgICAgICBvZmZzZXRfZGF0ZT1sYXN0X2RhdGUsCiAgICAgICAgICAgICBvZmZzZXRfaWQ9MCwKICAgICAgICAgICAgIG9mZnNldF9wZWVyPUlucHV0UGVlckVtcHR5KCksCiAgICAgICAgICAgICBsaW1pdD1jaHVua19zaXplLAogICAgICAgICAgICAgaGFzaCA9IDAKICAgICAgICAgKSkKY2hhdHMuZXh0ZW5kKHJlc3VsdC5jaGF0cykKIApmb3IgY2hhdCBpbiBjaGF0czoKICAgIHRyeToKICAgICAgICBpZiBjaGF0Lm1lZ2Fncm91cD09IFRydWU6CiAgICAgICAgICAgIGdyb3Vwcy5hcHBlbmQoY2hhdCkKICAgIGV4Y2VwdDoKICAgICAgICBjb250aW51ZQogCnByaW50KGdyKydbK10gQ2hvb3NlIGEgZ3JvdXAgdG8gc2NyYXBlIG1lbWJlcnMoKFNVTFRBTikpIDonK3JlKQppPTAKZm9yIGcgaW4gZ3JvdXBzOgogICAgcHJpbnQoZ3IrJ1snK2N5K3N0cihpKSsnXScgKyAnIC0gJyArIGcudGl0bGUpCiAgICBpKz0xCiAKcHJpbnQoJycpCmdfaW5kZXggPSBpbnB1dChncisiWytdIEVudGVyIGEgTnVtYmVyIDogIityZSkKdGFyZ2V0X2dyb3VwPWdyb3Vwc1tpbnQoZ19pbmRleCldCiAKcHJpbnQoZ3IrJ1srXSBGZXRjaGluZyBNZW1iZXJzLi4uJykKdGltZS5zbGVlcCgxKQphbGxfcGFydGljaXBhbnRzID0gW10KYWxsX3BhcnRpY2lwYW50cyA9IGNsaWVudC5nZXRfcGFydGljaXBhbnRzKHRhcmdldF9ncm91cCwgYWdncmVzc2l2ZT1UcnVlKQogCnByaW50KGdyKydbK10gU2F2aW5nIEluIGZpbGUuLi4nKQp0aW1lLnNsZWVwKDEpCndpdGggb3BlbigibWVtYmVycy5jc3YiLCJ3IixlbmNvZGluZz0nVVRGLTgnKSBhcyBmOgogICAgd3JpdGVyID0gY3N2LndyaXRlcihmLGRlbGltaXRlcj0iLCIsbGluZXRlcm1pbmF0b3I9IlxuIikKICAgIHdyaXRlci53cml0ZXJvdyhbJ3VzZXJuYW1lJywndXNlciBpZCcsICdhY2Nlc3MgaGFzaCcsJ25hbWUnLCdncm91cCcsICdncm91cCBpZCddKQogICAgZm9yIHVzZXIgaW4gYWxsX3BhcnRpY2lwYW50czoKICAgICAgICBpZiB1c2VyLnVzZXJuYW1lOgogICAgICAgICAgICB1c2VybmFtZT0gdXNlci51c2VybmFtZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHVzZXJuYW1lPSAiIgogICAgICAgIGlmIHVzZXIuZmlyc3RfbmFtZToKICAgICAgICAgICAgZmlyc3RfbmFtZT0gdXNlci5maXJzdF9uYW1lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZmlyc3RfbmFtZT0gIiIKICAgICAgICBpZiB1c2VyLmxhc3RfbmFtZToKICAgICAgICAgICAgbGFzdF9uYW1lPSB1c2VyLmxhc3RfbmFtZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxhc3RfbmFtZT0gIiIKICAgICAgICBuYW1lPSAoZmlyc3RfbmFtZSArICcgJyArIGxhc3RfbmFtZSkuc3RyaXAoKQogICAgICAgIHdyaXRlci53cml0ZXJvdyhbdXNlcm5hbWUsdXNlci5pZCx1c2VyLmFjY2Vzc19oYXNoLG5hbWUsdGFyZ2V0X2dyb3VwLnRpdGxlLCB0YXJnZXRfZ3JvdXAuaWRdKSAgICAgIApwcmludChncisnWytdIE1lbWJlcnMgc2NyYXBlZCBzdWNjZXNzZnVsbHkuIC4uLi4uLi4uLi4uLi5TSEFSSUFSIFJBU09PTEkuLi4uLi4uLi4uJykK'))